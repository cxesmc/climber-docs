<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Installation - CLIMBER-X-docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Installation";
        var mkdocs_page_input_path = "installation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CLIMBER-X-docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting started</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Installation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-get-the-code">1. Get the code</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-create-the-system-specific-makefile">2. Create the system-specific Makefile</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-compiling-climber-x">3. Compiling CLIMBER-X</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dependencies/">Dependencies</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quick-start/">Quick start</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Use cases</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../use-cases/01-piControl/">piControl</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../use-cases/02-historical/">historical</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Output description</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../var_lists/">Output files</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CLIMBER-X-docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Getting started</li>
      <li class="breadcrumb-item active">Installation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="installing-climber-x">Installing CLIMBER-X</h1>
<p>Here you can find the basic information and steps needed to install <strong>CLIMBER-X</strong>.</p>
<p>There are currently four different flavors of <strong>CLIMBER-X</strong> that can be set up:</p>
<ul>
<li><code>climber-clim</code>: minimal climate model configuration with atmosphere, ocean, sea ice and land (including dynamic vegetation)</li>
<li><code>climber-clim-bgc</code>: coupled climate-carbon cycle model configuration; clim plus with ocean biogeochemistry</li>
<li><code>climber-clim-ice</code>: coupled climate-ice sheet model configuration; clim plus with ice sheets</li>
<li><code>climber-clim-bgc-ice</code>: fully coupled model configuration; clim plus with ocean biogeochemistry and ice sheets</li>
</ul>
<p>The model dependencies vary according to the desired model configuration:</p>
<ul>
<li>Dependencies are: NetCDF, coordinates, Python3.x, runner, CDO</li>
<li>Additional dependencies if using coupled ice sheets are: Yelmo, LIS</li>
</ul>
<p>See: <a href="../dependencies/">Dependencies</a> for more details.</p>
<p>Follow the steps below to (1) obtain the code, (2) configure the Makefile(s) for your system,
(3) compile an executable program </p>
<h2 id="1-get-the-code">1. Get the code</h2>
<p>Clone the repository from <a href="https://github.com/cxesmc/climber-x">https://github.com/cxesmc/climber-x</a>:</p>
<pre><code class="language-bash"># Clone code repository
git clone https://github.com/cxesmc/climber-x.git
git clone git@github.com:cxesmc/climber-x.git # via ssh

cd climber-x

# Clone input file directory
git clone https://gitlab.pik-potsdam.de/cxesmc/climber-x-input.git input
git clone git@gitlab.pik-potsdam.de:cxesmc/climber-x-input.git input    # via ssh

</code></pre>
<p>If you plan to make changes to the code, it is wise to check out a new branch:</p>
<pre><code class="language-bash">git checkout -b user-dev
</code></pre>
<p>You should now be working on the branch <code>user-dev</code>.</p>
<p>If you would also like to run CLIMBER-X with an interactive carbon cycle, then the <strong>HAMOCC</strong>
ocean biogeochemistry (<code>bgc</code>) code must also be downloaded:</p>
<pre><code class="language-bash"># bgc
cd src/
git clone git@github.com:cxesmc/bgc.git
cd bgc/
git submodule update --init --recursive     # for submodule M4AGO 
cd ../..
</code></pre>
<p>Since the HAMOCC model code is not open source, the <code>bgc</code> repository is private at the moment and
you need to be given permission in order to access it. HAMOCC is covered by the Max Planck Institute for
Meteorology software licence agreement as part of the MPI-ESM (<a href="https://code.mpimet.mpg.de/attachments/download/26986/MPI-ESM_SLA_v3.4.pdf">https://code.mpimet.mpg.de/attachments/download/26986/MPI-ESM_SLA_v3.4.pdf</a>).
A pre-requisite to access the <code>bgc</code> repository is therefore that you agree to the MPI-ESM license
by following the steps outlined here: <a href="https://code.mpimet.mpg.de/projects/mpi-esm-license">https://code.mpimet.mpg.de/projects/mpi-esm-license</a>.
Once you have done so, send an email to <a href="mailto:matteo.willeit@gmail.com?subject=[GitHub]%20bgc%20source%20code">Matteo Willeit</a> and you will be granted permission to access the <code>bgc</code> repository.</p>
<p>If you would also like to run with an interactive ice sheet, the <strong>Yelmo</strong> ice-sheet code
must be downloaded and configured and the solid Earth model <strong>VILMA</strong> libraries must be
downloaded before compiling:</p>
<pre><code class="language-bash"># yelmo
cd src
git clone git@github.com:palma-ice/yelmo.git
cd yelmo
git checkout climber-x                     # Get climber-x branch
cd ../..            # Return to climber-x parent directory

# vilma
cd src/
git clone git@github.com:cxesmc/vilma.git  # private repository, premission needed
cd ..
</code></pre>
<h2 id="2-create-the-system-specific-makefile">2. Create the system-specific Makefile</h2>
<p>To compile <strong>CLIMBER-X</strong>, you need to generate a Makefile that is appropriate for your system. In the folder <code>config</code>, you need to specify a configuration file that defines the compiler and flags, including definition of the paths to the <code>NetCDF</code>, <code>FFTW</code>, <code>coordinates</code>, <code>Yelmo</code> and <code>LIS</code> libraries. Note that it can be convenient to install <code>FFTW</code>, <code>coordinates</code>, <code>Yelmo</code> and <code>LIS</code> as subdirectories of the <code>src/</code> folder, to be sure they are compiled consistently with <strong>CLIMBER-X</strong>.</p>
<p>You can use another configuration file in the config folder as a template, e.g.,</p>
<pre><code class="language-bash">cd config
cp pik_ifort myhost_mycompiler
</code></pre>
<p>Then you would modify the file <code>myhost_mycompiler</code> to match your paths. Back in <code>climber-x</code>, you can then generate your Makefile with the provided python configuration script:</p>
<pre><code class="language-bash">cd ../climber-x
python config.py config/myhost_mycompiler
</code></pre>
<p>The result should be a Makefile that is ready for use.</p>
<p>If you want to use the ice sheet model you have to similarly create the Makefile for Yelmo:</p>
<pre><code class="language-bash">cd src/yelmo/
python config.py config/myhost_mycompiler 
cd ../..
</code></pre>
<h2 id="3-compiling-climber-x">3. Compiling <strong>CLIMBER-X</strong></h2>
<p>Assuming the source has been downloaded and configured, and all <a href="../dependencies/">dependencies</a> have also been compiled, now you are ready to compile <strong>CLIMBER-X</strong>.</p>
<p>There are currently four different flavors of <strong>CLIMBER-X</strong> that can be compiled:</p>
<ul>
<li><code>climber-clim</code>: minimal climate configuration with atmosphere, ocean, sea ice and land</li>
<li><code>climber-clim-bgc</code>: clim plus with ocean biogeochemistry</li>
<li><code>climber-clim-ice</code>: clim plus with ice sheets</li>
<li><code>climber-clim-bgc-ice</code>: clim plus with ocean biogeochemistry and ice sheets</li>
</ul>
<p>These can be compiled by calling the individual names, e.g. <code>make climber-clim</code> or <code>make climber-clim-bgc-ice</code>. By default, it is also possible to call <code>make climber</code> as a shorter alias for <code>make climber-clim-bgc-ice</code>, e.g.:</p>
<pre><code class="language-bash">make clean
make climber
</code></pre>
<p>The climate only version <code>climber-clim</code> corresponds to the version described by Willeit et al. (2022). This particular model setup does not require non-climate source code or the LIS library for compilation.</p>
<p>That's it. The executable <code>climber.x</code> should now be available in the main directory.</p>
<p>To compile the model with debug flags enabled use:</p>
<pre><code class="language-bash">make climber debug=1
</code></pre>
<p>By default, the model is compiled with <code>openmp</code>. To compile the model without openmp use:</p>
<pre><code class="language-bash">make climber openmp=0
</code></pre>
<p>This version should typically not be used.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting-started/" class="btn btn-neutral float-left" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../usage/" class="btn btn-neutral float-right" title="Usage">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../getting-started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../usage/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
